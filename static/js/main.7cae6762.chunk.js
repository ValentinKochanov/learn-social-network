(this.webpackJsonptest_project=this.webpackJsonptest_project||[]).push([[0],{128:function(e,t,n){e.exports={news:"news_news__2JJIG"}},129:function(e,t,n){e.exports={music:"music_music__3b08i"}},130:function(e,t,n){e.exports={settings:"set_settings__xjRMS"}},159:function(e,t,n){},241:function(e,t,n){},283:function(e,t,n){"use strict";n.r(t);var r=n(0),s=(n(159),n(8)),c=n(123),i=n(124),o=n(5),a=n(125).create({withCredentials:!0,headers:{"API-KEY":"7c6fc181-8a70-4e32-948d-aca8d55e2c13"},baseURL:"https://social-network.samuraijs.com/api/1.0/"}),u=n(26),l="SET_USERS_DATA",j={id:null,login:null,email:null,isAuth:!1},d=function(e,t,n,r){return{type:l,data:{email:e,id:t,login:n,isAuth:r}}},b=function(){return function(e){a.get("auth/me").then((function(e){return e.data})).then((function(t){if(0===t.resultCode){var n=t.data,r=n.email,s=n.id,c=n.login;e(d(r,s,c,!0))}}))}},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l:return Object(o.a)(Object(o.a)({},e),t.data);default:return e}},f=n(41),p="SET_PHOTO",O="ADD-POST",g="SET_USERS_PROFILE",m="SET_STATUS",x={content:[{id:1,text:"abababa",likeCount:2},{id:2,text:"rthjhgf",likeCount:2}],profile:null,status:"---"},v=function(e){return{type:O,text:e}},C=function(e){return{type:m,status:e}},P=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:var n=e.content.length+1;return Object(o.a)(Object(o.a)({},e),{},{content:[{id:n,text:t.text,likeCount:0}].concat(Object(f.a)(e.content))});case g:return Object(o.a)(Object(o.a)({},e),{},{profile:t.profile});case m:return Object(o.a)(Object(o.a)({},e),{},{status:t.status});case p:return Object(o.a)(Object(o.a)({},e),{},{photo:t.photo});default:return e}},_="ADD-MESSAGE",w={dialog:[{name:"Andrey",id:1},{name:"Dmitry",id:2},{name:"Anatoliy",id:3}],messages:[{id:1,text:"Hey!"},{id:2,text:"How are you?"},{id:3,text:"LOL"},{id:4,text:"Good bye"}]},S=function(e){return{type:_,text:e}},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:var n=e.messages.length+1;return Object(o.a)(Object(o.a)({},e),{},{messages:[].concat(Object(f.a)(e.messages),[{id:n,text:t.text}])});default:return e}},T="FOLLOW",I="UNFOLLOW",E="SET_USERS",N="SET_USERS_TOTAL_COUNT",A="SET_CURRENT_PAGE",k="TOGGLE_IS_FOLLOWING_PROGRESS",U={users:[],pageSize:20,totalUserCount:null,currentPage:1,followingInProgress:[]},L=function(e,t){return{type:k,isFetching:e,userId:t}},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(o.a)(Object(o.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(o.a)(Object(o.a)({},e),{},{followed:!0}):e}))});case I:return Object(o.a)(Object(o.a)({},e),{},{users:e.users.map((function(e){return e.id===t.userId?Object(o.a)(Object(o.a)({},e),{},{followed:!1}):e}))});case E:return Object(o.a)(Object(o.a)({},e),{},{users:t.users});case N:return Object(o.a)(Object(o.a)({},e),{},{totalUserCount:t.totalCount});case A:return Object(o.a)(Object(o.a)({},e),{},{currentPage:t.currentPage});case k:return Object(o.a)(Object(o.a)({},e),{},{followingInProgress:t.isFetching?[].concat(Object(f.a)(e.followingInProgress),[t.userId]):e.followingInProgress.filter((function(e){return e!==t.userId}))});default:return e}},z="SET_INITIALIZED",D={initialized:!1},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z:return Object(o.a)(Object(o.a)({},e),{},{initialized:!0});default:return e}},R=Object(s.c)({contentPage:P,dialogsPage:y,usersPage:M,auth:h,form:c.a,app:F}),G=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,H=Object(s.e)(R,G(Object(s.a)(i.a))),J=n(1),W=n.n(J),K=n(60),V=n.n(K),X=n(14),B=n(15),Q=n(17),Y=n(16),q=(n(241),n(10)),Z=n(12),$=n(11),ee=n(85),te=n.n(ee),ne=function(e){return Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:e.login}),Object(r.jsx)("button",{onClick:e.logout,children:"logout"})]})},re=function(e){return Object(r.jsx)("div",{className:te.a.header,children:Object(r.jsx)("div",{className:te.a.login,children:e.isAuth?Object(r.jsx)(ne,{login:e.login,logout:e.LogoutThC}):Object(r.jsx)($.b,{to:"/login",children:"Login"})})})},se=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){return Object(X.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"render",value:function(){return Object(r.jsx)(re,Object(o.a)({},this.props))}}]),n}(W.a.Component),ce=Object(Z.b)((function(e){return{isAuth:e.auth.isAuth,login:e.auth.login}}),{LogoutThC:function(){return function(e){a.post("auth/logout").then((function(e){return e.data})).then((function(t){0===t.resultCode&&e(d(null,null,null,!1))}))}}})(se),ie=n(31),oe=n.n(ie),ae=function(e){return Object(r.jsxs)("div",{className:oe.a.sidebar,children:[Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/profile",activeClassName:oe.a.active,children:"Profile"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/messages",activeClassName:oe.a.active,children:"Messages"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/users",activeClassName:oe.a.active,children:"Users"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/news",activeClassName:oe.a.active,children:"News"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/music",activeClassName:oe.a.active,children:"Music"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/settings",activeClassName:oe.a.active,children:"Settings"})})]})},ue=n(63),le=n.n(ue),je=function(e){var t=e.content;return Object(r.jsx)(J.Fragment,{children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("div",{children:t.text}),Object(r.jsxs)("div",{children:["like - ",t.likeCount]})]})})},de=n(121),be=n(122),he=function(e){if(!e)return"Field required"},fe=function(e){return function(t){if(!(t&&t.length<=e))return"Max length ".concat(e," symbols")}},pe=n(131),Oe=n(88),ge=n.n(Oe),me=function(e){var t=e.input,n=e.meta,s=Object(pe.a)(e,["input","meta"]),c=n.error&&n.touched;return Object(r.jsxs)("div",{className:ge.a.formControl+" "+(c?ge.a.error:" "),children:[Object(r.jsx)("textarea",Object(o.a)(Object(o.a)({},t),s)),c&&Object(r.jsx)("span",{children:n.error})]})},xe=fe(50),ve=function(e){var t=e.handleSubmit;return Object(r.jsxs)("form",{onSubmit:t,className:le.a.content,children:[Object(r.jsx)("div",{children:Object(r.jsx)(de.a,{name:"newPost",component:me,type:"text",validate:[he,xe]})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{children:"Click"})})]})},Ce=ve=Object(be.a)({form:"newPosts"})(ve),Pe=n.p+"static/media/usersPhoto.1d6a4084.png",_e=n(51),we=function(e){var t=Object(J.useState)(!1),n=Object(_e.a)(t,2),s=n[0],c=n[1],i=Object(J.useState)(e.status),o=Object(_e.a)(i,2),a=o[0],u=o[1];Object(J.useEffect)((function(){u(e.status)}),[e.status]);return Object(r.jsxs)("div",{children:[!s&&Object(r.jsx)("div",{children:Object(r.jsx)("span",{onClick:function(){c((function(e){return!e}))},children:e.status})}),s&&Object(r.jsx)("div",{children:Object(r.jsx)("input",{onChange:function(e){u(e.currentTarget.value)},autoFocus:!0,value:a,onBlur:function(){c(!1),e.updateStatus(a)}})})]})},Se=function(e){if(!e.profile)return Object(r.jsx)(r.Fragment,{});var t=e.content.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(je,{content:e})},e.id)}));return Object(r.jsxs)("div",{className:le.a.content,children:[Object(r.jsx)("img",{src:e.profile.photos.small||Pe,alt:"users-avatar"}),e.isOwner&&Object(r.jsx)("input",{onChange:function(t){t.target.files.length&&e.savePhoto(t.target.files[0])},type:"file"}),Object(r.jsx)(we,{status:e.status,updateStatus:e.updateStatus}),Object(r.jsx)("div",{children:Object(r.jsx)(Ce,{onSubmit:e.submit})}),Object(r.jsx)("div",{children:t})]})},ye=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(X.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).submit=function(t){e.props.addPost(t.newPost)},e}return Object(B.a)(n,[{key:"refreshProfile",value:function(){var e=this.props.match.params.userId||this.props.authId;this.props.getStatusThC(e),this.props.getUserProfileThC(e)}},{key:"componentDidMount",value:function(){this.refreshProfile()}},{key:"componentDidUpdate",value:function(e,t,n){this.props.match.params.userId===e.match.params.userId&&this.props.profile||this.refreshProfile()}},{key:"render",value:function(){return Object(r.jsx)(Se,Object(o.a)(Object(o.a)({},this.props),{},{profile:this.props.profile,status:this.props.status,updateStatus:this.props.updateStatusThC,submit:this.submit,isOwner:!this.props.match.params.userId,savePhoto:this.props.savePhoto}))}}]),n}(W.a.Component),Te=Object(s.d)(Object(Z.b)((function(e){return{content:e.contentPage.content,profile:e.contentPage.profile,status:e.contentPage.status,authId:e.auth.id}}),{savePhoto:function(e){return function(t){(function(e){var t=new FormData;return t.append("image",e),a.put("/profile/photo",t,{headers:{"Content-Type":"multipart/form-data"}})})(e).then((function(e){0===e.resultCode&&t(function(e){return{type:p,photo:e}}(e.data.photo))}))}},addPost:function(e){return function(t){t(v(e)),t(Object(u.a)("newPosts"))}},getUserProfileThC:function(e){return function(t){(function(e){return a.get("profile/"+e).then((function(e){return e.data}))})(e).then((function(e){t({type:g,profile:e})}))}},getStatusThC:function(e){return function(t){(function(e){return a.get("profile/status/"+e).then((function(e){return e.data}))})(e).then((function(e){t(C(e))}))}},updateStatusThC:function(e){return function(t){(function(e){return a.put("profile/status",{status:e})})(e).then((function(n){0===n.data.resultCode&&t(C(e))}))}}}),q.f)(ye),Ie=function(e){return{isAuth:e.auth.isAuth}},Ee=n(40),Ne=n.n(Ee),Ae=function(e){return Object(r.jsx)("div",{className:Ne.a.message,children:e.text})},ke=function(e){var t="/messages/"+e.id;return Object(r.jsx)("div",{className:Ne.a.dialogs,children:Object(r.jsx)($.b,{to:t,children:e.name})})},Ue=fe(100),Le=function(e){var t=e.handleSubmit;return Object(r.jsxs)("form",{onSubmit:t,children:[Object(r.jsx)("div",{children:Object(r.jsx)(de.a,{name:"Messages",component:me,type:"text",validate:[he,Ue]})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{children:"Click"})})]})};Le=Object(be.a)({form:"newMessage"})(Le);var Me=function(e){var t=e.dialogs.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(ke,{name:e.name,id:e.id})},e.id)})),n=e.messages.map((function(e){return Object(r.jsx)("div",{children:Object(r.jsx)(Ae,{text:e.text})},e.id)}));return Object(r.jsxs)("div",{className:Ne.a.chat,children:[Object(r.jsx)("div",{children:t}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:n}),Object(r.jsx)(Le,{onSubmit:e.submit})]})]})},ze=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(X.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).submit=function(t){e.props.addMessage(t.Messages)},e}return Object(B.a)(n,[{key:"render",value:function(){return Object(r.jsx)(Me,{submit:this.submit,dialogs:this.props.dialogs,messages:this.props.messages})}}]),n}(W.a.Component),De=Object(s.d)(Object(Z.b)((function(e){return{dialogs:e.dialogsPage.dialog,messages:e.dialogsPage.messages}}),{addMessage:function(e){return function(t){t(S(e)),t(Object(u.a)("newMessage"))}}}),(function(e){var t=function(t){Object(Q.a)(s,t);var n=Object(Y.a)(s);function s(){return Object(X.a)(this,s),n.apply(this,arguments)}return Object(B.a)(s,[{key:"render",value:function(){return this.props.isAuth?Object(r.jsx)(e,Object(o.a)({},this.props)):Object(r.jsx)(q.a,{to:"/login"})}}]),s}(W.a.Component);return Object(Z.b)(Ie)(t)}))(ze),Fe=n(128),Re=n.n(Fe),Ge=function(){return Object(r.jsx)("div",{className:Re.a.news,children:"News"})},He=n(129),Je=n.n(He),We=function(){return Object(r.jsx)("div",{className:Je.a.music,children:"Music"})},Ke=n(130),Ve=n.n(Ke),Xe=function(){return Object(r.jsx)("div",{className:Ve.a.settings,children:"Settings"})},Be=n(65),Qe=n.n(Be),Ye=function(e){return Object(r.jsxs)("div",{className:Qe.a.users,children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:Object(r.jsx)($.b,{to:"/profile/"+e.user.id,children:Object(r.jsx)("img",{src:e.user.photos.small||Pe,alt:"users"})})}),Object(r.jsx)("div",{children:e.user.followed?Object(r.jsx)("button",{disabled:e.followingInProgress.some((function(t){return t===e.user.id})),onClick:function(){e.unfollowThC(e.user.id)},children:" Unfollow "}):Object(r.jsx)("button",{disabled:e.followingInProgress.some((function(t){return t===e.user.id})),onClick:function(){e.followThC(e.user.id)},children:" Follow "})})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{children:e.user.name}),Object(r.jsx)("div",{children:e.user.status})]})]},e.user.id)},qe=function(e){var t=Math.ceil(e.totalUserCount/e.pageSize),n=Object(J.useState)(1),s=Object(_e.a)(n,2),c=s[0],i=s[1],o=(c-1)*e.pageSize+1,a=c*e.pageSize;(e.currentPage<o||e.currentPage>a)&&e.onPageChanged(o);for(var u=[],l=1;l<=t;l++)u.push(l);return Object(r.jsxs)("div",{children:[c>1&&Object(r.jsx)("button",{onClick:function(){i(c-1)},children:"PREV"}),u.filter((function(e){return e>=o&&e<=a})).map((function(t){return Object(r.jsx)("button",{className:e.currentPage===t&&Qe.a.selectedPage,onClick:function(){e.onPageChanged(t)},children:t},t)})),t>c&&Object(r.jsx)("button",{onClick:function(){i(c+1)},children:"NEXT"})]})},Ze=function(e){return e.totalUserCount?Object(r.jsxs)("div",{children:[Object(r.jsx)(qe,{totalUserCount:e.totalUserCount,pageSize:e.pageSize,currentPage:e.currentPage,onPageChanged:e.onPageChanged}),e.users.map((function(t){return Object(r.jsx)(Ye,{user:t,followingInProgress:e.followingInProgress,unfollowThC:e.unfollowThC,followThC:e.followThC,onPageChanged:e.onPageChanged})}))]}):Object(r.jsx)("div",{children:"Loading..."})},$e=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(X.a)(this,n);for(var s=arguments.length,c=new Array(s),i=0;i<s;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).onPageChanged=function(t){e.props.getUsersThC(e.props.pageSize,t)},e.render=function(){return Object(r.jsx)(Ze,{totalUserCount:e.props.totalUserCount,pageSize:e.props.pageSize,currentPage:e.props.currentPage,onPageChanged:e.onPageChanged,users:e.props.users,followingInProgress:e.props.followingInProgress,unfollowThC:e.props.unfollowThC,followThC:e.props.followThC})},e}return Object(B.a)(n,[{key:"componentDidMount",value:function(){this.props.getUsersThC(this.props.pageSize,this.props.currentPage)}}]),n}(W.a.Component),et=Object(Z.b)((function(e){return{users:e.usersPage.users,totalUserCount:e.usersPage.totalUserCount,pageSize:e.usersPage.pageSize,currentPage:e.usersPage.currentPage,followingInProgress:e.usersPage.followingInProgress}}),{getUsersThC:function(e,t){return function(n){(function(e,t){return a.get("users?count=".concat(e,"&page=").concat(t)).then((function(e){return e.data}))})(e,t).then((function(e){var r;n(function(e){return{type:E,users:e}}(e.items)),n((r=e.totalCount,{type:N,totalCount:r})),n(function(e){return{type:A,currentPage:e}}(t))}))}},unfollowThC:function(e){return function(t){var n;t(L(!0,e)),(n=e,a.delete("follow/".concat(n)).then((function(e){return e.data}))).then((function(n){0===n.resultCode&&t(function(e){return{type:I,userId:e}}(e)),t(L(!1,e))}))}},followThC:function(e){return function(t){var n;t(L(!0,e)),(n=e,a.post("follow/".concat(n)).then((function(e){return e.data}))).then((function(n){0===n.resultCode&&t(function(e){return{type:T,userId:e}}(e)),t(L(!1,e))}))}}})($e),tt=n(91),nt=n.n(tt),rt=function(e){var t=e.handleSubmit;return e.isAuth?Object(r.jsx)(q.a,{to:"/profile"}):Object(r.jsx)("form",{onSubmit:t,children:Object(r.jsxs)("div",{className:nt.a.form,children:[Object(r.jsx)("div",{children:Object(r.jsx)(de.a,{name:"email",component:"input",type:"text",placeholder:"Email"})}),Object(r.jsx)("div",{children:Object(r.jsx)(de.a,{name:"password",component:"input",type:"text",placeholder:"Password"})}),Object(r.jsxs)("div",{children:[Object(r.jsx)(de.a,{name:"rememberMe",component:"input",type:"checkbox"}),"remember me"]}),e.error&&Object(r.jsx)("div",{className:nt.a.formSummaryError,children:e.error}),Object(r.jsx)("button",{type:"submit",children:"Login"})]})})},st=rt=Object(be.a)({form:"login"})(rt),ct=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){var e;Object(X.a)(this,n);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).submit=function(t){e.props.LoginThC(t.email,t.password,t.rememberMe)},e}return Object(B.a)(n,[{key:"render",value:function(){return Object(r.jsx)(st,{onSubmit:this.submit,isAuth:this.props.isAuth})}}]),n}(W.a.Component),it=Object(Z.b)((function(e){return{isAuth:e.auth.isAuth}}),{LoginThC:function(e,t,n){return function(r){(function(e,t,n){return a.post("auth/login",{email:e,password:t,rememberMe:n}).then((function(e){return e.data}))})(e,t,n).then((function(e){0===e.resultCode?r(b()):r(Object(u.b)("login",{_error:e.messages[0]}))}))}}})(ct),ot=function(e){Object(Q.a)(n,e);var t=Object(Y.a)(n);function n(){return Object(X.a)(this,n),t.apply(this,arguments)}return Object(B.a)(n,[{key:"componentDidMount",value:function(){this.props.initializesSuccess()}},{key:"render",value:function(){return this.props.initialized?Object(r.jsxs)("div",{className:"App",children:[Object(r.jsx)(ce,{}),Object(r.jsx)(ae,{}),Object(r.jsxs)("div",{className:"AppContent",children:[Object(r.jsx)(q.b,{path:"/profile/:userId?",render:function(){return Object(r.jsx)(Te,{})}}),Object(r.jsx)(q.b,{path:"/messages",render:function(){return Object(r.jsx)(De,{})}}),Object(r.jsx)(q.b,{path:"/news",component:function(){return Object(r.jsx)(Ge,{})}}),Object(r.jsx)(q.b,{path:"/users",render:function(){return Object(r.jsx)(et,{})}}),Object(r.jsx)(q.b,{path:"/music",component:We}),Object(r.jsx)(q.b,{path:"/settings",component:Xe}),Object(r.jsx)(q.b,{path:"/login",component:it})]})]}):Object(r.jsx)(r.Fragment,{})}}]),n}(W.a.Component),at=Object(s.d)(Object(Z.b)((function(e){return{initialized:e.app.initialized}}),{initializesSuccess:function(){return function(e){var t=e(b());Promise.all([t]).then((function(){e({type:z})}))}}}),q.f)(ot);V.a.render(Object(r.jsx)($.a,{children:Object(r.jsx)(Z.a,{store:H,children:Object(r.jsx)(at,{})})}),document.getElementById("root"))},31:function(e,t,n){e.exports={sidebar:"sidebar_sidebar__181c_",active:"sidebar_active__1Q0Ss"}},40:function(e,t,n){e.exports={chat:"messages_chat__17KVj",dialogs:"messages_dialogs__3oIgd",message:"messages_message__2OYe4"}},63:function(e,t,n){e.exports={content:"content_content__14H4I"}},65:function(e,t,n){e.exports={users:"users_users__3F3y1",selectedPage:"users_selectedPage__3TnCu"}},85:function(e,t,n){e.exports={header:"header_header__hC3A-",login:"header_login__1DtW7"}},88:function(e,t,n){e.exports={formControl:"formControl_formControl__3bwy2",error:"formControl_error__14QhK"}},91:function(e,t,n){e.exports={form:"login_form__3tG83",formSummaryError:"login_formSummaryError__jEn4j"}}},[[283,1,2]]]);
//# sourceMappingURL=main.7cae6762.chunk.js.map